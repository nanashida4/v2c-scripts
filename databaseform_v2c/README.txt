※V2Cの外部コマンドから呼び出し選択したMD5を読み込んで、Image Databaseの
　自動登録書式をクリップボードにコピーするようにできてるといいなぁ、というスクリプトです。
　不具合があるかもしれませんので覚悟の上で使ってください。
　特にエラーについてはまったく未処理。下の登録を間違えないでください。


※Windows XP Pro SP3 (x86)、java.version 1.6.0_16、V2Cバージョン [R20090926](L-0.5)
　でいちおう動きました。その他はわかりません...


※databaseform_v2c.jsがスクリプト本体でDBAutoRegForm.txtが登録書式を書いておくファイルです。
　2つともV2Cのscriptフォルダにいれてください。


・外部コマンドの設定

　選択テキストのところで
ラベル：書式未指定、コマンド：${SCRIPT:Fr} databaseform_v2c.js (0)
ラベル：雑誌書式、コマンド：${SCRIPT:Fr} databaseform_v2c.js (1)
ラベル：コミック書式、コマンド：${SCRIPT:Fr} databaseform_v2c.js (2)
ラベル：ゲーム書式、コマンド：${SCRIPT:Fr} databaseform_v2c.js (3)
ラベル：ゲーム書式u、コマンド：${SCRIPT:Fr} databaseform_v2c.js (3u)
ラベル：同人誌書式、コマンド：${SCRIPT:Fr} databaseform_v2c.js (4)
ラベル：イラスト書式、コマンド：${SCRIPT:Fr} databaseform_v2c.js (5)


※範囲選択して右クリックから利用してください。
　半角数字と大文字のA〜Fからなる32文字を正規表現で拾うようにしてありますので
　そういう文字列を2つ含まないように選択してください。
　含まれていない場合は終了します。


※選択した書式のタグがクリップボードにコピーされているはずですので、あとは書き込み欄に
　ペーストして、書式未指定以外はすでに記入されているものを消して登録内容を書き込んでください。
　(書式未指定以外ですでに記入されているものを消さずに書き込んでしまうと
　　作者名:[作者名]七菜氏
　 というように登録されてしまいますので、注意してください。)


※DBAutoRegForm.txtの書式はおそらく見ればわかると思います。

(書式指定)XX書式
[XX名]
[XX名]
[XXXX名]
<END>

　という、(書式指定)から<END>まででワンセットです。
　最後に「<END>」を付けないとその後も読み込んでしまうので注意。
　(書式指定)の後ろにある「XX書式」は書かなくてもかまいません。
　なお、順番に並べる必要はありません。
　新たに追加された場合は、DBAutoRegForm.txtに同じように記述してください。


※DBAutoRegForm.txtに同じ書式指定があると前にある方を使用するので注意してください。


※自分用の登録書式を使えるようにしてみました。
　書式指定を[[(適当な数字や文字列)]]でします。(文字列に ] を使わないでください。)
　書式指定はタグ作成時に (0) (書式未指定)に変換されます。

　例:
　1、DBAutoRegForm.txtに以下のように記述します。

[[p]]pixiv書式
絵師:
id:
URL:
作品名:
<END>

　2、以下のように選択テキストのところでコマンドの設定をします。

ラベル：pixiv書式、コマンド：${SCRIPT:Fr} databaseform_v2c.js [[p]]

　3、あとは同じようにコマンドを使うと下のようにコピーされるはずです。

[####(1)#(0123456789ABCDEF0123456789ABCDEF)#(0)####/]
絵師:
id:
URL:
作品名:
[/####(1)#(0123456789ABCDEF0123456789ABCDEF)#(0)####]



Finite
